# Как помочь


## Зависимости

Мы используем [poetry](https://github.com/python-poetry/poetry) для управления зависимостями.

Для их установки используйте аргумент `install`:

```bash
poetry install
```

Так же установим `pre commit hooks` в `git`:
```bash
poetry run pre-commit install
```

Для активации вашего `virtualenv` используйте `poetry shell`.


## Одна магическая команда

Используйте `make test` для запуска всего что у нас есть!

Так же из-за конфликта между `pytest-testmon` и `pytest-cov` мы используем аргумент `--no-cov` во время `make test` и таким
самым даем приоритет `pytest-testmon`. Если вы хотите сгенерировать отчет с помощью `pytest-cov`, используйте `make test ci=1`.


## Тестирование

Мы используем `black`, `flake8` и `pytest` для контроля качества.

Для запуска форматера:

```bash
black .
```

Для запуска линтера (он проверяет только doc-строки, [подробнее](http://www.pydocstyle.org/en/latest/error_codes.html)):
```bash
flake8 .
```

Для запуска всех тестов:

```bash
pytest
```

Если вы хотите настроить конфигурацию утилит, вы должны сделать это в `setup.cfg`.
Эти шаги являются обязательными во время CI.


## Проверки типов

Мы используем `mypy` для запуска проверки типов в нашем коде:

```bash
mypy .
```

Этот шаг является обязательными во время CI.

## Перевод

Для обновления `.po` файлов запустите `make translate`, после чего вы сможете редактировать перевод в `.po` файлах по пути
`locales/<тэг языка>/LC_MESSAGES/messages.po`. После редактирования, для компиляции можете еще раз запустить `make translate`.

Для добавления нового языка используйте `poetry run pybabel init -i locales/base.pot -l <тэг языка> -d locales`.

P.S. Тэг языка это короткое его название, например `en` или `en_EN`. Полный список вы можете посмотреть запустив
`poetry run pybabel --list-locales`.

### Перед началом работы

Перед подачей вашего кода убедитесь что:

1. Запустите тесты `pytest`, чтобы убедиться что всё работает
2. Добавьте правки
3. Добавьте тесты для правок
4. Отредактируйте документацию, если вы изменили что-то важное
5. Обновите `CHANGELOG.md` с коротким описанием Ваших изменений
6. Запустите тесты `pytest` снова, чтобы убедиться что всё работает
7. Запустите `mypy`, чтобы убедиться в корректности типов
8. Запустите `black`, чтобы убедиться в корректном стиле кода
9. Запустите `doc8` и `flake8`, чтобы убедиться что документация работает


## Другая помощь

Вы можете помочь проекту распространяя информацию о нём.
Так же большой поддержкой будет, например, написание
короткой статьи о том как вы используете этот проект.
Вы также можете делаться своими практиками с нами.
